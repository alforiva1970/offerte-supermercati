<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OfferteMax v5.0 (DeepSeek)</title>
  <link rel="icon" href="https://www.google.com/favicon.ico" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ›’ OfferteMax v5.0 (DeepSeek)</h1>
      <p>OCR Tesseract.js + Scanner Barcode</p>
    </div>
    <div class="main-content">
      <div class="stats-container" id="statsContainer">
        <div class="stat-card">
          <div class="stat-number" id="totalProducts">0</div>
          <div class="stat-label">Prodotti</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalSavings">â‚¬0</div>
          <div class="stat-label">Risparmi</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="bestDeal">-</div>
          <div class="stat-label">Miglior Affare</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="avgPrice">â‚¬0</div>
          <div class="stat-label">Prezzo Medio</div>
        </div>
      </div>
      <div class="section">
        <h2>ğŸ“– OCR Scanner Volantini</h2>
        <div class="btn-grid">
          <label class="btn" style="background: linear-gradient(45deg, #3498db, #2980b9); cursor: pointer;">
            ğŸ“· Scatta Foto<input type="file" accept="image/*" capture="camera" onchange="processOCRFlyer(event)"
              style="display: none;">
          </label>
          <label class="btn" style="background: linear-gradient(45deg, #9b59b6, #8e44ad); cursor: pointer;">
            ğŸ–¼ï¸ Carica Immagine<input type="file" accept="image/*" onchange="processOCRFlyer(event)"
              style="display: none;">
          </label>
        </div>
        <div id="flyerPreview" style="display: none; margin: 20px 0; text-align: center;">
          <img id="flyerImage" style="max-width: 100%; max-height: 300px; border-radius: 10px;">
          <div class="btn-grid-2" style="margin-top: 15px;">
            <button class="btn" onclick="startOCRAnalysis()"
              style="background: linear-gradient(45deg, #27ae60, #2ecc71);" id="analyzeOCRBtn">ğŸ” Avvia OCR</button>
            <button class="btn" onclick="clearFlyerPreview()"
              style="background: linear-gradient(45deg, #e74c3c, #c0392b);">âŒ Rimuovi</button>
          </div>
        </div>
        <div id="ocrProgress"
          style="display: none; background: rgba(39, 174, 96, 0.1); border: 1px solid #27ae60; border-radius: 10px; padding: 15px; margin: 15px 0;">
          <div id="ocrStatus">ğŸ” Inizializzazione OCR...</div>
          <div class="progress-container">
            <div class="progress-bar" id="ocrProgressBar"></div>
          </div>
        </div>
        <div id="flyerResults" style="display: none; margin-top: 20px;">
          <h3>ğŸ¯ Offerte Estratte:</h3>
          <div id="extractedOffers" class="products-grid"></div>
          <button class="btn" onclick="addAllExtractedOffers()"
            style="background: linear-gradient(45deg, #27ae60, #2ecc71);">âœ… Aggiungi Tutte</button>
        </div>
      </div>
      <div class="section">
        <h2>ğŸ“± Scanner Barcode</h2>
        <button class="btn" onclick="toggleScanner()"
          style="background: linear-gradient(45deg, #27ae60, #2ecc71); font-size: 1.1em; min-height: 60px;">ğŸ“· Avvia
          Scanner</button>
        <div class="scanner-container" id="scannerContainer">
          <div id="scanner-preview"></div>
          <div class="scanner-overlay"></div>
          <button class="btn" onclick="stopScanner()"
            style="background: linear-gradient(45deg, #e74c3c, #c0392b); position: absolute; bottom: 20px;">âŒ
            Chiudi</button>
        </div>
        <div id="barcodeResult"
          style="display: none; background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 20px; border-radius: 15px; margin: 15px 0;">
          <div id="barcodeCode" style="font-family: 'Courier New', monospace; font-size: 1.2em; font-weight: 700;">
          </div>
          <div id="barcodeName"></div>
          <button class="btn" onclick="useBarcodeResult()">âœ… Usa Questo</button>
        </div>
        <div class="form-row">
          <input type="text" id="productName" placeholder="Nome prodotto" class="form-input" />
          <input type="number" id="productPrice" placeholder="Prezzo â‚¬" step="0.01" class="form-input" />
        </div>
        <div class="form-row">
          <select id="supermarketSelect" class="form-input">
            <option value="">Seleziona supermercato</option>
            <option value="Conad">Conad</option>
            <option value="Coop">Coop</option>
            <option value="Esselunga">Esselunga</option>
            <option value="Lidl">Lidl</option>
            <option value="MD">MD</option>
            <option value="Altro">Altro</option>
          </select>
          <button class="btn" onclick="addProduct()"
            style="background: linear-gradient(45deg, #27ae60, #2ecc71); margin: 0;">â• Aggiungi</button>
        </div>
      </div>
      <div class="section">
        <h2>ğŸ† I Tuoi Prodotti</h2>
        <input type="text" id="searchInput" placeholder="ğŸ” Cerca prodotti..." class="form-input" />
        <div id="productsContainer" class="products-grid">
          <div style="text-align: center; padding: 40px; color: #666; grid-column: 1 / -1;">
            <h3>Nessun prodotto ancora</h3>
            <p>Inizia usando lo scanner o l'OCR!</p>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>âš™ï¸ Gestione Dati</h2>
        <div class="btn-grid">
          <button class="btn" onclick="exportData()">ğŸ“¤ Esporta</button>
          <label class="btn" style="cursor: pointer;">ğŸ“¥ Importa<input type="file" accept=".json"
              onchange="importData(event)" style="display: none;"></label>
          <button class="btn" onclick="clearAllData()" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">ğŸ—‘ï¸
            Cancella Tutto</button>
        </div>
      </div>
    </div>
  </div>
  <script src="app.js"></script>
</body>

</html>